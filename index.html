<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ¬ë¡€ì¤‘í•™êµ í•™ì‚¬ë ¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; text-align: center; background-color: #f9fafb; margin: 0; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); background-color: #e5e7eb; gap: 1px; border: 1px solid #e5e7eb; }
        .day-cell { min-height: 110px; background-color: white; padding: 6px; text-align: left; vertical-align: top; }
        input, select, button { text-align: center; border-radius: 0.5rem; }
        .event-item { font-size: 10px; padding: 2px 4px; margin-bottom: 2px; border-radius: 4px; border-left: 3px solid #3b82f6; background-color: #eff6ff; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        @media (max-width: 640px) { .day-cell { min-height: 80px; font-size: 0.75rem; } }
    </style>
</head>
<body>

    <nav class="bg-blue-900 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold cursor-pointer" onclick="location.reload()">ğŸ« êµ¬ë¡€ì¤‘í•™êµ í•™ì‚¬ë ¥</h1>
            <div class="flex gap-2">
                <button onclick="changeView('yearly')" class="px-4 py-1.5 bg-blue-700 hover:bg-blue-800 rounded-lg text-sm font-bold transition">1ë…„</button>
                <button onclick="changeView('monthly')" class="px-4 py-1.5 bg-blue-700 hover:bg-blue-800 rounded-lg text-sm font-bold transition">ì›”ê°„</button>
                <button onclick="changeView('weekly')" class="px-4 py-1.5 bg-blue-700 hover:bg-blue-800 rounded-lg text-sm font-bold transition">ì£¼ê°„</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 max-w-6xl">
        <section class="bg-white p-6 rounded-2xl shadow-sm border mb-6">
            <h2 class="text-lg font-bold mb-4 text-blue-900">ğŸ“ í•™ì‚¬ ì¼ì • ë“±ë¡</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-3">
                <input type="date" id="eventDate" class="w-full md:w-auto border border-gray-300 p-2.5 outline-none focus:ring-2 focus:ring-blue-500">
                <input type="text" id="eventTitle" placeholder="í–‰ì‚¬ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full md:w-80 border border-gray-300 p-2.5 outline-none focus:ring-2 focus:ring-blue-500">
                <select id="eventDept" class="w-full md:w-auto border border-gray-300 p-2.5 outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">ë¶€ì„œ ì„ íƒ</option>
                    <option value="êµë¬´ë¶€">êµë¬´ë¶€</option>
                    <option value="ì—°êµ¬ë¶€">ì—°êµ¬ë¶€</option>
                    <option value="í•™ìƒë¶€">í•™ìƒë¶€</option>
                    <option value="ì°½ì˜ì¸ì„±ë¶€">ì°½ì˜ì¸ì„±ë¶€</option>
                    <option value="êµê°">êµê°</option>
                    <option value="êµì¥">êµì¥</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
                <button onclick="addEvent()" class="w-full md:w-32 bg-blue-600 text-white p-2.5 font-bold hover:bg-blue-700 shadow-md active:scale-95 transition">ì¼ì • ì €ì¥</button>
            </div>
            <p class="text-xs text-gray-400 mt-3 font-medium">* ë¶€ì„œëŠ” ì„ íƒ ì‹œ ìœ ì§€ë˜ë©°, í–‰ì‚¬ ë‚´ìš©ë§Œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.</p>
        </section>

        <div class="flex justify-center items-center gap-6 mb-6 py-2">
            <button onclick="moveTime(-1)" class="p-2 text-blue-600 hover:bg-blue-50 rounded-full transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"></path></svg></button>
            <h2 id="viewTitle" class="text-xl md:text-2xl font-extrabold text-gray-800 min-w-[280px]">í™”ë©´ ì¤€ë¹„ ì¤‘...</h2>
            <button onclick="moveTime(1)" class="p-2 text-blue-600 hover:bg-blue-50 rounded-full transition"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path></svg></button>
        </div>

        <div id="contentArea" class="bg-white p-2 md:p-6 rounded-2xl shadow-xl min-h-[500px]"></div>
    </main>

    <script>
        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì´ˆê¸°í™” (ë°ì´í„° ì¶©ëŒ ë°©ì§€ ë¡œì§ í¬í•¨)
        let events = [];
        try {
            const saved = localStorage.getItem('gure_final_data');
            events = saved ? JSON.parse(saved) : [];
        } catch (e) {
            events = [];
            localStorage.removeItem('gure_final_data');
        }

        let currentView = 'monthly';
        let viewDate = new Date();

        function addEvent() {
            const date = document.getElementById('eventDate').value;
            const title = document.getElementById('eventTitle').value;
            const dept = document.getElementById('eventDept').value;
            if(!date || !title || !dept) return alert("ë‚ ì§œ, ë‚´ìš©, ë¶€ì„œë¥¼ ëª¨ë‘ í™•ì¸í•´ì£¼ì„¸ìš”!");
            
            events.push({ id: Date.now(), date, title, dept });
            localStorage.setItem('gure_final_data', JSON.stringify(events));
            
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventTitle').focus();
            render();
        }

        function deleteEvent(id) {
            if(!confirm("ì´ ì¼ì •ì„ ì‚­ì œí• ê¹Œìš”?")) return;
            events = events.filter(e => e.id !== id);
            localStorage.setItem('gure_final_data', JSON.stringify(events));
            render();
        }

        function moveTime(n) {
            if(currentView === 'yearly') viewDate.setFullYear(viewDate.getFullYear() + n);
            else if(currentView === 'monthly') viewDate.setMonth(viewDate.getMonth() + n);
            else if(currentView === 'weekly') viewDate.setDate(viewDate.getDate() + (n * 7));
            render();
        }

        function changeView(v) { currentView = v; render(); }

        function render() {
            const area = document.getElementById('contentArea');
            const title = document.getElementById('viewTitle');
            if(!area) return;
            area.innerHTML = '';

            const y = viewDate.getFullYear();
            const m = viewDate.getMonth();

            if(currentView === 'monthly') {
                title.innerText = `${y}ë…„ ${m + 1}ì›” ê³„íš`;
                let html = '<div class="calendar-grid">';
                ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(d => html += `<div class="bg-gray-50 p-3 font-bold text-xs text-center border-b border-gray-200">${d}</div>`);
                
                const firstDay = new Date(y, m, 1).getDay();
                const lastDate = new Date(y, m + 1, 0).getDate();
                
                for(let i=0; i<firstDay; i++) html += '<div class="day-cell bg-gray-50/50"></div>';
                for(let d=1; d<=lastDate; d++) {
                    const dStr = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                    const items = events.filter(e => e.date === dStr);
                    html += `<div class="day-cell"><div class="text-xs font-bold mb-2 text-gray-400">${d}</div>`;
                    items.forEach(e => html += `<div class="event-item" title="${e.title}">[${e.dept}] ${e.title}</div>`);
                    html += `</div>`;
                }
                area.innerHTML = html + '</div>';

            } else if(currentView === 'weekly') {
                const tempDate = new Date(viewDate);
                const day = tempDate.getDay();
                const diff = tempDate.getDate() - day + (day === 0 ? -6 : 1);
                const mon = new Date(tempDate.setDate(diff));
                const fri = new Date(new Date(mon).getTime() + (4 * 24 * 60 * 60 * 1000));
                
                const fmt = (t) => `${t.getMonth()+1}.${t.getDate()}.(${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][t.getDay()]})`;
                title.innerText = `ì£¼ê°„ê³„íš (${fmt(mon)} - ${fmt(fri)})`;

                const startStr = mon.toISOString().split('T')[0];
                const endStr = fri.toISOString().split('T')[0];
                const items = events.filter(e => e.date >= startStr && e.date <= endStr).sort((a,b)=>a.date.localeCompare(b.date));

                let html = '<div class="overflow-x-auto"><table class
