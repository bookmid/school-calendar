<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ¬ë¡€ì¤‘í•™êµ í•™ì‚¬ë ¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; text-align: center; background-color: #f9fafb; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: left; background-color: #e5e7eb; gap: 1px; border: 1px solid #e5e7eb; }
        .day-cell { min-height: 100px; background-color: white; padding: 4px; overflow-y: auto; }
        input, select, button { text-align: center; }
        @media (max-width: 640px) { .day-cell { min-height: 70px; font-size: 0.7rem; } }
    </style>
</head>
<body>

    <nav class="bg-blue-900 text-white p-4 shadow-md sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold cursor-pointer" onclick="location.reload()">ğŸ« êµ¬ë¡€ì¤‘í•™êµ í•™ì‚¬ë ¥</h1>
            <div class="flex gap-2">
                <button onclick="changeView('yearly')" class="px-3 py-1 bg-blue-700 hover:bg-blue-800 rounded text-sm font-bold">1ë…„</button>
                <button onclick="changeView('monthly')" class="px-3 py-1 bg-blue-700 hover:bg-blue-800 rounded text-sm font-bold">ì›”ê°„</button>
                <button onclick="changeView('weekly')" class="px-3 py-1 bg-blue-700 hover:bg-blue-800 rounded text-sm font-bold">ì£¼ê°„</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 max-w-6xl">
        <section class="bg-white p-6 rounded-xl shadow-sm border mb-6">
            <div class="flex flex-col md:flex-row justify-center items-center gap-3">
                <input type="date" id="eventDate" class="border p-2 rounded text-sm">
                <input type="text" id="eventTitle" placeholder="í–‰ì‚¬ ë‚´ìš© ì…ë ¥" class="w-full md:w-80 border p-2 rounded text-sm">
                <select id="eventDept" class="border p-2 rounded text-sm">
                    <option value="">ë¶€ì„œ ì„ íƒ</option>
                    <option value="êµë¬´ë¶€">êµë¬´ë¶€</option>
                    <option value="ì—°êµ¬ë¶€">ì—°êµ¬ë¶€</option>
                    <option value="í•™ìƒë¶€">í•™ìƒë¶€</option>
                    <option value="ì°½ì˜ì¸ì„±ë¶€">ì°½ì˜ì¸ì„±ë¶€</option>
                    <option value="êµê°">êµê°</option>
                    <option value="êµì¥">êµì¥</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
                <button onclick="addEvent()" class="bg-blue-600 text-white px-6 py-2 rounded font-bold hover:bg-blue-700 transition">ì €ì¥</button>
            </div>
        </section>

        <div class="flex justify-center items-center gap-8 mb-6">
            <button onclick="moveTime(-1)" class="text-3xl font-bold text-blue-600">â—€</button>
            <h2 id="viewTitle" class="text-2xl font-bold text-gray-800 min-w-[300px]"></h2>
            <button onclick="moveTime(1)" class="text-3xl font-bold text-blue-600">â–¶</button>
        </div>

        <div id="displayArea" class="bg-white p-4 rounded-xl shadow-md min-h-[500px]"></div>
    </main>

    <script>
        let events = JSON.parse(localStorage.getItem('gure_events')) || [];
        let currentView = 'monthly';
        let viewDate = new Date();

        function addEvent() {
            const date = document.getElementById('eventDate').value;
            const title = document.getElementById('eventTitle').value;
            const dept = document.getElementById('eventDept').value;
            if(!date || !title || !dept) return alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!");
            
            events.push({ id: Date.now(), date, title, dept });
            localStorage.setItem('gure_events', JSON.stringify(events));
            
            document.getElementById('eventTitle').value = ''; // ë‚´ìš©ë§Œ ì§€ìš°ê¸°
            document.getElementById('eventTitle').focus();
            render();
        }

        function deleteEvent(id) {
            if(!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            events = events.filter(e => e.id !== id);
            localStorage.setItem('gure_events', JSON.stringify(events));
            render();
        }

        function moveTime(n) {
            if(currentView === 'yearly') viewDate.setFullYear(viewDate.getFullYear() + n);
            else if(currentView === 'monthly') viewDate.setMonth(viewDate.getMonth() + n);
            else if(currentView === 'weekly') viewDate.setDate(viewDate.getDate() + (n * 7));
            render();
        }

        function changeView(v) { currentView = v; render(); }

        function render() {
            const area = document.getElementById('displayArea');
            const title = document.getElementById('viewTitle');
            area.innerHTML = '';

            if(currentView === 'monthly') {
                const y = viewDate.getFullYear();
                const m = viewDate.getMonth();
                title.innerText = `${y}ë…„ ${m + 1}ì›” ê³„íš`;
                
                let html = '<div class="calendar-grid">';
                ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(d => html += `<div class="bg-gray-100 p-2 font-bold text-sm text-center">${d}</div>`);
                
                const firstDay = new Date(y, m, 1).getDay();
                const lastDate = new Date(y, m + 1, 0).getDate();
                
                for(let i=0; i<firstDay; i++) html += '<div class="day-cell bg-gray-50"></div>';
                for(let d=1; d<=lastDate; d++) {
                    const dStr = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                    const items = events.filter(e => e.date === dStr);
                    html += `<div class="day-cell"><div class="text-xs font-bold mb-1">${d}</div>`;
                    items.forEach(e => html += `<div class="text-[10px] bg-blue-50 border-l-2 border-blue-400 p-1 mb-1">[${e.dept}] ${e.title}</div>`);
                    html += `</div>`;
                }
                area.innerHTML = html + '</div>';

            } else if(currentView === 'weekly') {
                const d = new Date(viewDate);
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1);
                const mon = new Date(d.setDate(diff));
                const fri = new Date(new Date(mon).setDate(mon.getDate() + 4));
                
                const fmt = (t) => `${t.getMonth()+1}.${t.getDate()}.(${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][t.getDay()]})`;
                title.innerText = `ì£¼ê°„ê³„íš (${fmt(mon)} - ${fmt(fri)})`;

                const start = mon.toISOString().split('T')[0];
                const end = fri.toISOString().split
